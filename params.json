{"name":"Cleaningdataproject","tagline":"Coursera getting and cleaning data","body":"# cleaningdataproject\r\nCoursera Course Getting and Cleaning Data \r\n\r\n\r\n- title:\"run_analysis\"\r\n- author: \"Shawnzoom\"\r\n- date: \"October, 2015\"\r\n\r\nThe document outlines work performed by Shawnzoom for the Coursera course Getting and Cleaning Data to produce a tidy dataset\r\nwith an R script called run_analysis.R. Where practical, this document includes snippets of the output from R Console to help\r\nthe readed better track the development of the script.\r\n\r\nThe purpose of this work is to create one R script called run_analysis.R that does the following tasks:\r\n\r\n1. Merges the training and the test sets to create one data set.\r\n2. Extracts only the measurements on the mean and standard deviation for each measurement. \r\n3. Uses descriptive activity names to name the activities in the data set\r\n4. Appropriately labels the data set with descriptive variable names. \r\n5. From the data set in step 4, creates a second, independent tidy data set with the average of each variable for each activity and each subject.\r\n\r\non the following dataset:\r\n\r\nhttps://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip\r\n\r\nThe dataset has been downloaded and expanded into the following directory e:/rcode/GettingDataProject\r\n\r\n```{r eval=FALSE}\r\n# load libraries\r\nlibrary(stringr)\r\nlibrary(plyr)\r\nlibrary(reshape2)\r\n\r\n\r\n```\r\n\r\n\r\n```{r eval= FALSE}\r\n# Set the working dir to the location with the expanded dataset\r\nsetwd(\"e:/rcode/GettingDataProject/UCI HAR Dataset\")\r\nproject_dir <- getwd()\r\nproject_dir\r\n\r\n```\r\n\r\n```{r eval= FALSE}\r\n# list directory structure of the dataset\r\nlist.dirs()\r\n\r\n```\r\n\r\n\r\n```\r\n[1] \".\"                        \"./test\"                   \"./test/Inertial Signals\" \r\n[4] \"./train\"                  \"./train/Inertial Signals\"\r\n\r\n```\r\n```{r eval= FALSE}\r\n# list files in  \"./test\"  dir\r\n\r\ntest_files1 <- list.files(\"./test\")\r\ntest_files1\r\n\r\n```\r\n```\r\n[1] \"Inertial Signals\" \"subject_test.txt\" \"X_test.txt\"       \"y_test.txt\" \r\n```\r\n\r\n```{r eval= FALSE}\r\n# list files in  \"./test/Inertial Signals\" dir\r\ntest_files2 <- list.files(\"./test/Inertial Signals\")\r\ntest_files2\r\n```\r\n```\r\n[1] \"body_acc_x_test.txt\"  \"body_acc_y_test.txt\"  \"body_acc_z_test.txt\"  \"body_gyro_x_test.txt\"\r\n[5] \"body_gyro_y_test.txt\" \"body_gyro_z_test.txt\" \"total_acc_x_test.txt\" \"total_acc_y_test.txt\"\r\n[9] \"total_acc_z_test.txt\"\r\n```\r\n\r\n```{r eval= FALSE}\r\n# list files in  \"./train\"  dir\r\ntrain_files1 <- list.files(\"./train\")\r\ntrain_files1\r\n```\r\n```\r\n[1] \"Inertial Signals\"  \"subject_train.txt\" \"X_train.txt\"       \"y_train.txt\"    \r\n```\r\n\r\n\r\n```{r eval= FALSE}\r\n# list files in  \"./train/Inertial Signals\" dir\r\ntrain_files2 <- list.files(\"./train/Inertial Signals\")\r\ntrain_files2\r\n\r\n```\r\n```\r\n[1] \"body_acc_x_train.txt\"  \"body_acc_y_train.txt\"  \"body_acc_z_train.txt\"  \"body_gyro_x_train.txt\"\r\n[5] \"body_gyro_y_train.txt\" \"body_gyro_z_train.txt\" \"total_acc_x_train.txt\" \"total_acc_y_train.txt\"\r\n[9] \"total_acc_z_train.txt\"\r\n```\r\n\r\n### 1. Merges the training and the test sets to create one combined dataset.  ###\r\n\r\n```{r eval= FALSE}\r\n# create the 'top-level' combined directory\r\nif (!file.exists(\"./combined\")) {\r\n  dir.create(\"./combined\")\r\n}\r\nlist.dirs()\r\n\r\n```\r\n```\r\n\r\n```\r\n[1] \".\"                        \"./combined\"               \"./test\"                  \r\n[4] \"./test/Inertial Signals\"  \"./train\"                  \"./train/Inertial Signals\"\r\n```\r\n\r\n```{r eval= FALSE}\r\n# create the 'Inertial Signals' direcoty for the  combined directory\r\nif (!file.exists(\"./combined/Inertial Signals\")) {\r\n  dir.create(\"./combined/Inertial Signals\")\r\n}\r\nlist.dirs()\r\n```\r\n```\r\n[1] \".\"                           \"./combined\"                  \"./combined/Inertial Signals\"\r\n[4] \"./test\"                      \"./test/Inertial Signals\"     \"./train\"                    \r\n[7] \"./train/Inertial Signals\" \r\n\r\n```\r\n\r\n\r\nThe follwing algorithm will be used to create a combined dataset:\r\n\r\n1. copy the files from the train dataset to the respective combined directories\r\n2. append to these files, the files from the test dataset\r\n3. rename the files in the combined dir. That is, replace 'train' in all the file names with 'combined'\r\n\r\n**Copy files**\r\n\r\n```{r eval= FALSE}\r\n# copy the files from the train dataset the respective combined directory\r\n\r\ntmp_workdir <- paste(project_dir, \"/train\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir) \r\n\r\nfile.copy(train_files1,\"../combined\", overwrite = FALSE, recursive = FALSE )\r\n\r\n# reset project working dir\r\nsetwd(project_dir) \r\n\r\ncombined_files1 <- list.files(\"./combined\")\r\ncombined_files1\r\n\r\n```\r\n\r\n```\r\n[1] \"Inertial Signals\"  \"subject_train.txt\" \"X_train.txt\"       \"y_train.txt\"  \r\n```\r\n\r\n```{r eval= FALSE}\r\n# copy the files from the train/Inertial Signals dataset the respective combined directory\r\n\r\ntmp_workdir <- paste(project_dir, \"/train/Inertial Signals\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir)\r\n\r\nfile.copy(train_files2,\"../../combined/Inertial Signals\", overwrite = FALSE, recursive = FALSE )\r\n\r\n# reset project working dir\r\nsetwd(project_dir)\r\n\r\ncombined_files2 <- list.files(\"./combined/Inertial Signals\")\r\ncombined_files2\r\n\r\n```\r\n```\r\n[1] \"body_acc_x_train.txt\"  \"body_acc_y_train.txt\"  \"body_acc_z_train.txt\" \r\n[4] \"body_gyro_x_train.txt\" \"body_gyro_y_train.txt\" \"body_gyro_z_train.txt\"\r\n[7] \"total_acc_x_train.txt\" \"total_acc_y_train.txt\" \"total_acc_z_train.txt\"\r\n```\r\n\r\n**Append files /UCI HAR Dataset/combined**\r\n```{r eval=FALSE}\r\n\r\ntmp_workdir <- paste(project_dir, \"/combined\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir)\r\n  \r\nfile_to_append <- paste(project_dir,\"/test\", \"/\",\"subject_test.txt\" ,sep=\"\" )\r\nfile.append(\"subject_train.txt\", file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test\", \"/\",\"X_test.txt\" ,sep=\"\" )\r\nfile.append(\"X_train.txt\", file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test\", \"/\",\"y_test.txt\" ,sep=\"\" )\r\nfile.append(\"y_train.txt\", file_to_append)\r\n\r\n# reset project working dir\r\nsetwd(project_dir)\r\n\r\n```\r\n\r\n**Append files /UCI HAR Dataset/combined/Inertial Signals**\r\n```{r eval=FALSE}\r\n\r\ntmp_workdir <- paste(project_dir, \"/combined/Inertial Signals\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir)\r\n  \r\n\r\n#\r\n# body_acc files\r\n#\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_acc_x_test.txt\" ,sep=\"\")\r\nfile.append(\"body_acc_x_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_acc_y_test.txt\" ,sep=\"\")\r\nfile.append(\"body_acc_y_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_acc_z_test.txt\" ,sep=\"\")\r\nfile.append(\"body_acc_z_train.txt\"  , file_to_append)\r\n\r\n#\r\n# body_gyro files\r\n#\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_gyro_x_test.txt\" ,sep=\"\")\r\nfile.append(\"body_gyro_x_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_gyro_y_test.txt\" ,sep=\"\")\r\nfile.append(\"body_gyro_y_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"body_gyro_z_test.txt\" ,sep=\"\")\r\nfile.append(\"body_gyro_z_train.txt\" , file_to_append)\r\n\r\n#\r\n# total_acc files\r\n#\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"total_acc_x_test.txt\" ,sep=\"\")\r\nfile.append(\"total_acc_x_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"total_acc_y_test.txt\" ,sep=\"\")\r\nfile.append(\"total_acc_y_train.txt\" , file_to_append)\r\n\r\nfile_to_append <- paste(project_dir,\"/test/Inertial Signals\", \"/\",\"total_acc_z_test.txt\" ,sep=\"\")\r\nfile.append(\"total_acc_z_train.txt\" , file_to_append)\r\n\r\n# reset project working dir\r\nsetwd(project_dir)\r\n\r\n```\r\n\r\n**Rename files /UCI HAR Dataset/combined**\r\n```{r eval=FALSE}\r\ntmp_workdir <- paste(project_dir, \"/combined\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir)\r\n\r\nfile.rename(\"subject_train.txt\", \"subject_combined.txt\" )\r\nfile.rename(\"X_train.txt\", \"X_combined.txt\")\r\nfile.rename(\"y_train.txt\", \"y_combined.txt\")\r\n\r\nlist.files()\r\n\r\n# reset project working dir\r\nsetwd(project_dir)\r\n\r\n```\r\n\r\n**Rename files /UCI HAR Dataset/combined/Inertial Signals**\r\n\r\n```{r eval= FALSE}\r\n\r\ntmp_workdir <- paste(project_dir, \"/combined/Inertial Signals\", sep =\"\" ) \r\n\r\n# set temporary working dir\r\nsetwd(tmp_workdir)\r\n  \r\n\r\n#\r\n# body_acc files\r\n#\r\n\r\nfile.rename(\"body_acc_x_train.txt\" , \"body_acc_x_combined.txt\")\r\nfile.rename(\"body_acc_y_train.txt\" , \"body_acc_y_combined.txt\")\r\nfile.rename(\"body_acc_z_train.txt\"  , \"body_acc_z_combined.txt\")\r\n\r\n#\r\n# body_gyro files\r\n#\r\n\r\nfile.rename(\"body_gyro_x_train.txt\" , \"body_gyro_x_combined.txt\")\r\nfile.rename(\"body_gyro_y_train.txt\" , \"body_gyro_y_combined.txt\")\r\nfile.rename(\"body_gyro_z_train.txt\" , \"body_gyro_z_combined.txt\")\r\n\r\n#\r\n# total_acc files\r\n#\r\n\r\nfile.rename(\"total_acc_x_train.txt\" , \"total_acc_x_combined.txt\")\r\nfile.rename(\"total_acc_y_train.txt\" , \"total_acc_y_combined.txt\")\r\nfile.rename(\"total_acc_z_train.txt\" , \"total_acc_z_combined.txt\")\r\n\r\n# reset project working dir\r\nsetwd(project_dir)\r\n\r\n```\r\n\r\n```\r\n> list.files(\"./combined\")\r\n[1] \"Inertial Signals\"     \"subject_combined.txt\" \"X_combined.txt\"      \r\n[4] \"y_combined.txt\" \r\n\r\n> list.files(\"./combined/Inertial Signals\")\r\n[1] \"body_acc_x_combined.txt\"  \"body_acc_y_combined.txt\"  \"body_acc_z_combined.txt\" \r\n[4] \"body_gyro_x_combined.txt\" \"body_gyro_y_combined.txt\" \"body_gyro_z_combined.txt\"\r\n[7] \"total_acc_x_combined.txt\" \"total_acc_y_combined.txt\" \"total_acc_z_combined.txt\"\r\n```\r\n\r\n\r\n### 2. Extracts only the measurements on the mean and standard deviation for each measurement. ###\r\n\r\n\r\n```{r eval=FALSE}\r\n\r\n# Set the working dir to the location with the expanded dataset\r\n\r\n#list files in project_dir\r\nlist.files(project_dir)\r\n\r\n```\r\n```\r\n# Before any processing, the dataset directory looks like...\r\n\r\n[1] \"activity_labels.txt\" \"combined\"            \"features.txt\"        \"features_info.txt\"  \r\n[5] \"README.txt\"          \"test\"                \"train\" \r\n```\r\n```\r\nFrom the README.txt\r\nThe set of variables that were estimated from these signals are: \r\n\r\nmean(): Mean value\r\nstd(): Standard deviation\r\n```\r\n\r\nBy examining Readme.txt, features_info.txt and features.txt, all the measurements on the mean and standard deviation have mean() or std(), in their feature titles, respectively. Additionally, the features.txt file contains an index for the feature. For this execise, the additional vectors with **mean** in their titles will be ignored.\r\n\r\n\r\n```\r\nFor example, the first 8 rows of features.txt have the following values. Rows 1-3, contain mean measurements and rows 4-6, contain standard deviation measurements. So, by reading the features.txt file it is possible to get the indexes for all the measurements on mean and standard deviation.\r\n\r\n1 tBodyAcc-mean()-X\r\n2 tBodyAcc-mean()-Y\r\n3 tBodyAcc-mean()-Z\r\n4 tBodyAcc-std()-X\r\n5 tBodyAcc-std()-Y\r\n6 tBodyAcc-std()-Z\r\n7 tBodyAcc-mad()-X\r\n8 tBodyAcc-mad()-Y\r\n\r\nAnd... as an example, the following will be ignored\r\n294 fBodyAcc-meanFreq()-X\r\n295 fBodyAcc-meanFreq()-Y\r\n296 fBodyAcc-meanFreq()-Z\r\n```\r\nThe following will be the algorithm used to extract only the measurements on the mean and standard deviation for each measurement.\r\n\r\n```\r\n1. Create a file called features_mean_std.txt that is a subset of features.txt and only contains the features for the measuresments described above.\r\n2. Create an index file called index_mean_std.txt \r\n3. Use index file to create subset of the combined dataset\r\n\r\n```\r\n\r\n```{r eval=FALSE}\r\n#read the features file into a data frame called features\r\nfeatures <- read.table(\"features.txt\",  sep = \" \")\r\n\r\n#subset the features data frame                 \r\nfeatures_mean_std <- subset(features, grepl(\"std()\", V2, fixed = TRUE) | grepl(\"mean()\", V2, fixed = TRUE) )\r\nnrow(features_mean_std)\r\n```\r\n```\r\n[1] 66\r\nThis is the expected result after verifaction using search, in a simple text editor\r\n```\r\n```{r eval=FALSE}\r\n#Create features-mean_std.txt by writing the features_mean_std data frame to a file\r\nwrite.table(features_mean_std, file = \"features_mean_std.txt\", sep = \",\", row.names = FALSE, col.names = FALSE)\r\nlist.files()\r\n\r\n```\r\n\r\n```\r\n[1] \"activity_labels.txt\"   \"combined\"              \"features.txt\"         \r\n[4] \"features_info.txt\"     \"features_mean_std.txt\" \"README.txt\"           \r\n[7] \"test\"                  \"train\"\r\n```\r\n\r\n```{r eval=FALSE}\r\n# create the index file index_mean_std.txt by subsetting features_mean_std\r\nindex_mean_std <- subset(features_mean_std, V1 == V1, select = c(V1))\r\nwrite.table(index_mean_std, file = \"index_mean_std.txt\", sep = \",\", row.names = FALSE, col.names = FALSE)\r\nlist.files()\r\n```\r\n\r\n```\r\n# The dataset directory now looks like...\r\n\r\n[1] \"activity_labels.txt\"   \"combined\"              \"features.txt\"         \r\n[4] \"features_info.txt\"     \"features_mean_std.txt\" \"index_mean_std.txt\"   \r\n[7] \"README.txt\"            \"test\"                  \"train\"   \r\n```\r\n\r\nMake a directory called cleaningdata, to store the data that will subsetted from the combined data\r\n\r\n```{r eval= FALSE}\r\n# create a 'cleaingdata' directory \r\nif (!file.exists(\"cleaningdata\")) {\r\n  dir.create(\"cleaningdata\")\r\n}\r\nlist.dirs()\r\n```\r\n\r\n```\r\n[1] \".\"                           \"./cleaningdata\"              \"./combined\"                 \r\n[4] \"./combined/Inertial Signals\" \"./test\"                      \"./test/Inertial Signals\"    \r\n[7] \"./train\"                     \"./train/Inertial Signals\" \r\n```\r\n\r\n\r\n```{r eval=FALSE}\r\n# read the combined dataset into a data frame\r\nX_combined <- read.table(\"./combined/X_combined.txt\",  sep = \"\")\r\nncol(X_combined)\r\nnrow(X_combined)\r\n```\r\n\r\n\r\nAs expected this gives the following results\r\n```\r\n> ncol(X_combined)\r\n[1] 561\r\n> nrow(X_combined)\r\n[1] 10299\r\n```\r\n```{r eval= FALSE}\r\n\r\n# use index_mean_std to subset the combined dataset\r\n# first, transpose index_mean_std. This is so it can be used as vector for subsettung operations\r\nt_index_mean_std <- t(index_mean_std)\r\n\r\n# create subset data frame\r\nX_cleaningdata <- X_combined[,t_index_mean_std]\r\n\r\n#check numbers of rows and cols\r\nncol(X_cleaningdata)\r\nnrow(X_cleaningdata)\r\n\r\n```\r\n\r\nAs expected this gives the following results\r\n```\r\n> ncol(X_cleaningdata)\r\n[1] 66\r\n> nrow(X_cleaningdata)\r\n[1] 10299\r\n```\r\n\r\nSave the subset data frame to the cleaningdata directory\r\n```{r eval=FALSE}\r\n# create file cleaningdata.txt in the cleaningdata directory\r\nwrite.table(X_cleaningdata, file = \"./cleaningdata/X_cleaningdata.txt\", sep = \",\", row.names = FALSE, col.names = FALSE, append = FALSE)\r\nlist.files(\"./cleaningdata\")\r\n\r\n```\r\nAs expected\r\n```\r\n> list.files(./cleaningdata\")\r\n[1] \"X_cleaningdata.txt\"\r\n```\r\n\r\n**\"X_cleaningdata.txt\" contains the subset ofthe combined dataset as requested.**\r\n\r\n### 3. Uses descriptive activity names to name the activities in the data set ###\r\n\r\n```\r\nFrom the README.txt it states \"Each person performed six activities (WALKING, WALKING\\_UPSTAIRS, WALKING\\_DOWNSTAIRS, SITTING, STANDING, LAYING)\". These activties are coded in the file y_combined.txt , in the combined dataset, as follows. That is, the numbers 1-6 are used in place of the descriptive names of the activity. The coding is located in the file \"./UCI HAR Dataset/activity_labels\"\r\n```\r\n\r\n```\r\n1 WALKING\r\n2 WALKING_UPSTAIRS\r\n3 WALKING_DOWNSTAIRS\r\n4 SITTING\r\n5 STANDING\r\n6 LAYING\r\n```\r\n\r\n\r\nThe steps that follow are to create a file called y_cleaningdata.txt that has descriptive activity names, and saves it in the cleaningdata directory\r\n\r\n```{r eval=FALSE}\r\n# read the original that codes activity labels into a data frame\r\nactivity_labels <- read.table(\"activity_labels.txt\",  sep = \"\")\r\nncol(activity_labels)\r\nnrow(activity_labels)\r\n\r\n```\r\n```\r\n> ncol(activity_labels)\r\n[1] 2\r\n> nrow(activity_labels)\r\n[1] 6\r\n```\r\n\r\n```{r eval=FALSE}\r\n# read the  activities from the combined dataset into a data frame\r\ny_combined <- read.table(\"./combined/y_combined.txt\",  sep = \"\")\r\nncol(y_combined)\r\nnrow(y_combined)\r\n\r\n```\r\n```\r\n> ncol(y_combined)\r\n[1] 1\r\n> nrow(y_combined)\r\n[1] 10299\r\n```\r\n\r\n\r\n```{r eval=FALSE}\r\n# make a copy of the data frame of coded activity levels \r\n\r\ny_cleaningdata <- y_combined\r\n\r\n#Recode this data frame using the following function recoderFunc. \r\n#\r\n# https://susanejohnston.wordpress.com/2012/10/01/find-and-replace-in-r-part-2-how-to-recode-many-value# s-simultaneously/\r\n# Credit: Susan Johnston\r\n#\r\n\r\nrecoderFunc <- function(data, oldvalue, newvalue) {\r\n\r\n    # convert any factors to characters\r\n\r\n    if (is.factor(data))     data     <- as.character(data)\r\n    if (is.factor(oldvalue)) oldvalue <- as.character(oldvalue)\r\n    if (is.factor(newvalue)) newvalue <- as.character(newvalue)\r\n\r\n    # create the return vector\r\n\r\n    newvec <- data\r\n\r\n    # put recoded values into the correct position in the return vector\r\n\r\n    for (i in unique(oldvalue)) newvec[data == i] <- newvalue[oldvalue == i]\r\n\r\n    newvec\r\n\r\n}\r\n\r\ny_cleaningdata <- recoderFunc(y_cleaningdata, activity_labels$V1, activity_labels$V2)\r\n\r\nhead(y_cleaningdata)\r\n```\r\n\r\n```\r\n\r\n        V1\r\n1 STANDING\r\n2 STANDING\r\n3 STANDING\r\n4 STANDING\r\n5 STANDING\r\n6 STANDING\r\n```\r\n\r\n```{r eval=FALSE}\r\n# Add a colname called 'testActivity'\r\ncolnames(y_cleaningdata) <- c('testActivity')\r\nhead(y_cleaningdata)\r\n\r\n```\r\n```\r\n> head(y_cleaningdata)\r\n  testActivity\r\n1     STANDING\r\n2     STANDING\r\n3     STANDING\r\n4     STANDING\r\n5     STANDING\r\n6     STANDING\r\n```\r\n\r\n\r\n```{r eval=FALSE}\r\n# write the file y_cleaningdata.txt in the cleaningdata directory\r\nwrite.table(y_cleaningdata, file = \"./cleaningdata/y_cleaningdata.txt\", sep = \",\", row.names = FALSE, col.names = TRUE)\r\nlist.files(\"./cleaningdata\")\r\n\r\n```\r\n\r\n\r\n### 4. Appropriately label the data set with descriptive variable names. ###\r\n\r\n**Part 1: Handling X_cleaningdata.txt**\r\n\r\nThe subset dataset X\\_cleaningdata.txt currently has no variable names associated with the columns. The variable names that should be added to this dataset are contained in the file **features_mean_std.txt** (only contains the variable names with **mean()** or **std()** in the name ) which is derived the **features.txt** in the combined dataset.\r\n\r\n\r\nThe steps complete this task are as follows\r\n\r\n1. Copy features_mean_std.txt from the combined directory to the cleaning data directory\r\n2. Read the file into a data frame and drop the first column\r\n3. Transpose the data frame to a vector\r\n4. Read the file X_cleaningdata.txt into a data\r\n5. Add the vector from step 4 as the first row X_cleaningdata data frame\r\n6. Write the X_cleaningdata data frame to a file\r\n\r\n\r\n\r\n\r\n```{r eval=FALSE}\r\n# Copy features_mean_std.txt from the combined directory to the cleaning data directory\r\nfile.copy(\"features_mean_std.txt\"    ,\"./cleaningdata/features_mean_std.txt\", overwrite = FALSE, recursive = FALSE )\r\nlist.files(\"./cleaningdata\")\r\n\r\n```\r\n\r\n```\r\n[1] \"features_mean_std.txt\" \"X_cleaningdata.txt\"    \"y_cleaningdata.txt\"   \r\n```\r\n\r\n```{r eval=FALSE}\r\n# Read the file into a data frame and drop the first column\r\nfeatures_mean_std.df <- read.table(\"./cleaningdata/features_mean_std.txt\",  sep = \",\")\r\n\r\nncol(features_mean_std.df)\r\nnrow(features_mean_std.df)\r\n\r\n#Result:\r\n#\r\n#> ncol(features_mean_std.df)\r\n#[1] 2\r\n#> nrow(features_mean_std.df)\r\n#[1] 66\r\n\r\n# drop the first column\r\ndropped.feature_mean_std <- subset(features_mean_std.df, select=-c(V1))\r\n\r\n# Transpose the data frame to a vector\r\nt_features_mean_std.df <- as.vector(t(dropped.feature_mean_std))\r\n\r\n# remove special punctuation characters\r\nt_features_mean_std.df <-str_replace_all(t_features_mean_std.df, \"[[:punct:]]\", \"\")\r\n\r\nstr(t_features_mean_std.df)\r\n```\r\n```\r\n> str(t_features_mean_std.df)\r\n chr [1:66] \"tBodyAccmeanX\" \"tBodyAccmeanY\" \"tBodyAccmeanZ\" \"tBodyAccstdX\" ...\r\n\r\n```\r\n\r\n```{r eval=FALSE}\r\n# Read the file X_cleaningdata.txt into a data\r\nX_cleaningdata <- read.table(\"./cleaningdata/X_cleaningdata.txt\",  sep = \",\")\r\nncol(X_cleaningdata)\r\n```\r\n```\r\nThe number of columns in X_cleaningdata matches the number of columns in t_features_mean_std.df\r\n> ncol(X_cleaningdata)\r\n[1] 66\r\n```\r\n```{r eval=FALSE}\r\n# Preview teh head of X_cleaningdata\r\nhead(X_cleaningdata)\r\n\r\n```\r\n```\r\nA snippet\r\n> head(X_cleaningdata)\r\n         V1          V2         V3         V4         V5         V6        V7\r\n1 0.2885845 -0.02029417 -0.1329051 -0.9952786 -0.9831106 -0.9135264 0.9633961\r\n2 0.2784188 -0.01641057 -0.1235202 -0.9982453 -0.9753002 -0.9603220 0.9665611\r\n3 0.2796531 -0.01946716 -0.1134617 -0.9953796 -0.9671870 -0.9789440 0.9668781\r\n4 0.2791739 -0.02620065 -0.1232826 -0.9960915 -0.9834027 -0.9906751 0.9676152\r\n5 0.2766288 -0.01656965 -0.1153619 -0.9981386 -0.9808173 -0.9904816 0.9682244\r\n6 0.2771988 -0.01009785 -0.1051373 -0.9973350 -0.9904868 -0.9954200 0.9679482\r\n```\r\n\r\n\r\n\r\n```{r eval=FALSE}\r\n# Add the vector from step 4 as the first row X_cleaningdata data frame\r\ncolnames(X_cleaningdata) <- t_features_mean_std.df\r\n\r\n# preview head of cleaning data\r\nhead(X_cleaningdata)\r\n```\r\n\r\n```\r\nHere is a snippet of the head()\r\n> head(X_cleaningdata)\r\n\r\n  tBodyAccmeanX tBodyAccmeanY tBodyAccmeanZ tBodyAccstdX tBodyAccstdY tBodyAccstdZ\r\n1     0.2885845   -0.02029417    -0.1329051   -0.9952786   -0.9831106   -0.9135264\r\n2     0.2784188   -0.01641057    -0.1235202   -0.9982453   -0.9753002   -0.9603220\r\n3     0.2796531   -0.01946716    -0.1134617   -0.9953796   -0.9671870   -0.9789440\r\n4     0.2791739   -0.02620065    -0.1232826   -0.9960915   -0.9834027   -0.9906751\r\n5     0.2766288   -0.01656965    -0.1153619   -0.9981386   -0.9808173   -0.9904816\r\n6     0.2771988   -0.01009785    -0.1051373   -0.9973350   -0.9904868   -0.9954200\r\n```\r\n\r\nSave the subset data frame to the cleaningdata directory\r\n```{r eval=FALSE}\r\n\r\n# Write the X_cleaningdata data frame to a file, Overwrite existing file and write column names\r\n\r\nwrite.table(X_cleaningdata, file = \"./cleaningdata/X_cleaningdata.txt\", sep = \",\", row.names = FALSE, col.names = TRUE, append = FALSE)\r\n\r\n```\r\n**Part 2: Creating subject_cleaningdata.txt from subject_combined.txt**\r\n\r\nSteps\r\n\r\n1. Copy file from combined directory to cleaningdata directory\r\n2. Read file into data frame\r\n3. Add a colname called 'testSubject'\r\n4. Write the file back out again\r\n\r\n```{r eval=FALSE}\r\n\r\n# Copy subject_combined.txt from the combined directory to the cleaning data directory\r\n\r\nfile.copy(\"./combined/subject_combined.txt\" , \"./cleaningdata/subject_cleaningdata.txt\", overwrite = FALSE, recursive = FALSE )\r\n\r\nlist.files(\"./cleaningdata\")\r\n```\r\n```\r\n> list.files(\"./cleaningdata\")\r\n[1] \"features_mean_std.txt\"    \"subject_cleaningdata.txt\" \"X_cleaningdata.txt\"      \r\n[4] \"y_cleaningdata.txt\"\r\n```\r\n\r\n\r\n```{r eval=FALSE}\r\n# Read the file subject_cleaningdata.txt into a data\r\nsubject_cleaningdata <- read.table(\"./cleaningdata/subject_cleaningdata.txt\",  sep = \"\")\r\n\r\n# Add a colname called 'testSubject'\r\ncolnames(subject_cleaningdata) <- c('testSubject')\r\n\r\nhead(subject_cleaningdata)\r\n```\r\n```\r\n> head(subject_cleaningdata)\r\n  testSubject\r\n1           1\r\n2           1\r\n3           1\r\n4           1\r\n5           1\r\n6           1\r\n```\r\nSave the subset data frame to the cleaningdata directory\r\n```{r eval=FALSE}\r\n# Write the subject_cleaningdata data frame to a file, Overwrite existing file and write column names\r\nwrite.table(subject_cleaningdata, file = \"./cleaningdata/subject_cleaningdata.txt\", sep = \"\", row.names = FALSE, col.names = TRUE, append = FALSE)\r\n\r\n```\r\n \r\n### 5. From the data set in step 4, creates a second, independent tidy data set with the average of each variable for each activity and each subject. ###\r\n\r\n\r\n```{r eval=FALSE}\r\n\r\n# Set the working dir to the location with the expanded dataset\r\nsetwd(project_dir)\r\n\r\n#list files in project_dir\r\nlist.dirs(project_dir)\r\n\r\n```\r\n```\r\n[1] \"e:/rcode/GettingDataProject/UCI HAR Dataset\"                          \r\n[2] \"e:/rcode/GettingDataProject/UCI HAR Dataset/cleaningdata\"             \r\n[3] \"e:/rcode/GettingDataProject/UCI HAR Dataset/combined\"                 \r\n[4] \"e:/rcode/GettingDataProject/UCI HAR Dataset/combined/Inertial Signals\"\r\n[5] \"e:/rcode/GettingDataProject/UCI HAR Dataset/test\"                     \r\n[6] \"e:/rcode/GettingDataProject/UCI HAR Dataset/test/Inertial Signals\"    \r\n[7] \"e:/rcode/GettingDataProject/UCI HAR Dataset/train\"                    \r\n[8] \"e:/rcode/GettingDataProject/UCI HAR Dataset/train/Inertial Signals\"   \r\n```\r\n\r\nMake a directory called tidydata, to store the data that will be created from the cleadingdata\r\n\r\n```{r eval= FALSE}\r\n# create a 'cleaingdata' directory \r\nif (!file.exists(\"tidydata\")) {\r\n  dir.create(\"tidydata\")\r\n}\r\nlist.dirs()\r\n```\r\n```\r\n> list.dirs()\r\n[1] \".\"                           \"./cleaningdata\"             \r\n[3] \"./combined\"                  \"./combined/Inertial Signals\"\r\n[5] \"./test\"                      \"./test/Inertial Signals\"    \r\n[7] \"./tidydata\"                  \"./train\"                    \r\n[9] \"./train/Inertial Signals\" \r\n```\r\n```{r eval=FALSE}\r\n# Check the dimensions of the data frames that will be used for this exercise\r\n\r\ndim(y_cleaningdata)\r\n# [1] 10299     1\r\ndim(subject_cleaningdata)\r\n# [1] 10299     1\r\ndim(X_cleaningdata)\r\n#[1] 10299    66\r\n```\r\n\r\n\r\n\r\n```{r eval= FALSE}\r\n#merge data frames by creating an index and then doing a join\r\ny_cleaningdata <- cbind(id=c(1:10299), y_cleaningdata)\r\n\r\nX_cleaningdata <- cbind(id=c(1:10299), X_cleaningdata)\r\n\r\nsubject_cleaningdata <- cbind(id=c(1:10299), subject_cleaningdata)\r\n\r\n# Join data frames\r\ndflist <- list(subject_cleaningdata, y_cleaningdata, X_cleaningdata)\r\ntidydata <- join_all(dflist)\r\n\r\n#id is no longer needed and it can be dropper\r\ntidydata <- subset(tidydata, select=-c(id))\r\n\r\n```\r\n\r\n```\r\nThere are 30 test subjects and 6 activities and 66 variables per observation. Therefor the final dimesions of the tidydata dataset should be 180 (30 x 6) rows, by 66 columns\r\n```\r\n\r\n```{r eval=FALSE}\r\n\r\n#Use testSubject and testActivity as the id\r\nmeltedTidyData<- melt(tidydata, id=c(\"testSubject\", \"testActivity\"), na.rm = TRUE)\r\n\r\n\r\ndim(meltedTidyData)\r\n# [1] 679734      4\r\n\r\n\r\ntidydata <- acast(meltedTidyData, testSubject + testActivity ~ variable, mean)\r\ndim(tidydata)\r\n# [1] 180  66\r\n\r\nhead(tidydata)\r\ntail(tidydata)\r\n\r\n\r\n```\r\n\r\n\r\n```\r\nSnippet (of head)\r\n                     tBodyAccmeanX tBodyAccmeanY tBodyAccmeanZ tBodyAccstdX tBodyAccstdY tBodyAccstdZ\r\n1_LAYING                 0.2215982  -0.040513953    -0.1132036  -0.92805647 -0.836827406  -0.82606140\r\n1_SITTING                0.2612376  -0.001308288    -0.1045442  -0.97722901 -0.922618642  -0.93958629\r\n1_STANDING               0.2789176  -0.016137590    -0.1106018  -0.99575990 -0.973190056  -0.97977588\r\n1_WALKING                0.2773308  -0.017383819    -0.1111481  -0.28374026  0.114461337  -0.26002790\r\n1_WALKING_DOWNSTAIRS     0.2891883  -0.009918505    -0.1075662   0.03003534 -0.031935943  -0.23043421\r\n1_WALKING_UPSTAIRS       0.2554617  -0.023953149    -0.0973020  -0.35470803 -0.002320265  -0.01947924\r\n\r\n\r\nSnippet (of tail)\r\n                     tBodyAccmeanX tBodyAccmeanY tBodyAccmeanZ tBodyAccstdX\r\n30_LAYING                 0.2810339  -0.019449410   -0.10365815  -0.97636252\r\n30_SITTING                0.2683361  -0.008047313   -0.09951545  -0.98362274\r\n30_STANDING               0.2771127  -0.017016389   -0.10875621  -0.97755943\r\n30_WALKING                0.2764068  -0.017588039   -0.09862471  -0.34639428\r\n30_WALKING_DOWNSTAIRS     0.2831906  -0.017438390   -0.09997814  -0.05777032\r\n30_WALKING_UPSTAIRS       0.2714156  -0.025331170   -0.12469749  -0.35050448\r\n\r\n```\r\n\r\nSave the tidydata data frame to the tidydata directory without row names. Note: This required to submit the assignment\r\n```{r eval=FALSE}\r\n# Write the tidy data frame to a file, Overwrite existing file and write column names and not row names\r\nwrite.table(tidydata, file = \"./tidydata/tidydata.txt\", sep = \",\", row.names = FALSE, col.names = TRUE, append = FALSE)\r\n\r\n```\r\n\r\nRead the tidydata.txt back to confirm rows are gone\r\n```{r eval= FALSE}\r\n\r\n# \r\ntidydata_minus_rownames <- read.table(\"./tidydata/tidydata.txt\",  header = TRUE, sep = \",\")\r\n\r\nhead(tidydata_minus_rownames)\r\n\r\n```\r\n\r\n```\r\n\r\nSnippet of head(tidydata_minus_rownames)\r\n  tBodyAccmeanX tBodyAccmeanY tBodyAccmeanZ tBodyAccstdX tBodyAccstdY tBodyAccstdZ\r\n1     0.2215982  -0.040513953    -0.1132036  -0.92805647 -0.836827406  -0.82606140\r\n2     0.2612376  -0.001308288    -0.1045442  -0.97722901 -0.922618642  -0.93958629\r\n3     0.2789176  -0.016137590    -0.1106018  -0.99575990 -0.973190056  -0.97977588\r\n4     0.2773308  -0.017383819    -0.1111481  -0.28374026  0.114461337  -0.26002790\r\n5     0.2891883  -0.009918505    -0.1075662   0.03003534 -0.031935943  -0.23043421\r\n6     0.2554617  -0.023953149    -0.0973020  -0.35470803 -0.002320265  -0.01947924\r\n```\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}